var AASandbox=AAcom("browserdetect","utilities","commonsetup",function(AAUI){AAUI.viewReservationList=function(){var secure=AASandbox.getProperty("account.isSecure");var viewChange=AASandbox.getProperty("myreservations.viewChange");if(secure==="true"){AAUI.viewReservationListSecure(viewChange);}};AAUI.viewReservationListSecure=function(viewChange){var self=this;self.busyStart=function(){jQuery("#aa-viewReservationsLoading").show();};self.busyStop=function(){jQuery("#aa-viewReservationsLoading").hide();};jQuery("#aa-viewReservationsSecure").hide();self.busyStart();jQuery.ajax({url:"/home/ajax/mytrips",type:"GET",async:true,cache:false,timeout:60000,dataType:"JSON",success:function(ajaxResponse,textStatus,xhr){if(!self.errorHandler(textStatus,ajaxResponse)){reservations=ajaxResponse;self.updateReservationList(reservations.reservations);}},error:function(xhr,textStatus){self.errorHandler(textStatus,xhr.responseText);},complete:function(){self.busyStop();}});self.updateReservationList=function(reservations){var reservationCount=reservations.length>5?5:reservations.length;var triptable=jQuery("#mytrips-reservationlist");triptable.empty();for(var i=0;i<reservationCount;i++){res=reservations[i];mytripsRow="<tr>";if(i%2==1){mytripsRow='<tr class="aa-altRow">';}triptable.append(mytripsRow+"<td>"+res.departureDate+"</td><td>"+res.originAirportCode+"</td><td>"+res.reservationName+'</td><td class="aa-align-center aa-whitespace"> <a href="/reservation/selectReservationSubmit.do?fromHomePage=true&recordLocator='+res.recordLocator+'" title="'+viewChange+'"><span>'+viewChange+"</span></a> </td></tr>");}if(reservationCount==0){jQuery("#mytrips-noreservations").show();jQuery("#mytrips-reservationtable").hide();}else{jQuery("#mytrips-noreservations").hide();}if(reservations.length>5){jQuery("#mytrips-viewall").show();}jQuery("#aa-viewReservationsSecure").show();};self.errorHandler=function(status,ajaxResponse){var jqResponse=jQuery(ajaxResponse);if(status=="timeout"||ajaxResponse=="invalidState"||jqResponse.find(".js-invalidState").length>0){top.location.href="/invalidState.do";return true;}else{if(status=="error"||ajaxResponse=="systemError"||jqResponse.find(".js-systemError").length>0){top.location.href="/systemError.do";return true;}}return false;};jQuery("#findReservationForm\\.submit").removeClass("btn-inline");jQuery("#findReservationForm\\.firstName").focus().focus();};AAUI.setPlaceholders=function(){var fields=jQuery(".placeholder");fields.each(function(){jQuery(this).attr("placeholder",jQuery(this).siblings(".value").text());});};$j(document).ready(function(){AAUI.setPlaceholders();jQuery("#booking-module-tabs").tabs("option","activate",function(event,ui){if(ui.newTab.attr("id")=="aa-hp-module-tabs-changeRes%aa-viewReservations"){viewReservationList();}});if(aaHeroSlides.length>0){$j("#aa-hp-ad-hero").aaHeroAds(aaHeroSlides,{hideControls:1});}$j.stripeTables(".aa-zebra");$j.tableToLinks("#aa-table-fareSales","a.aa-currency-lrg");});});