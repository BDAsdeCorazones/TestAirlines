insert into ciudad values('Frankfur', 'Alemania', 5939, 'fssd', 'CET', 'Frankfurt Airport');
insert into ciudad values('Berlin', 'Alemania', 6047, 'fssd', 'CET', 'dsf');
insert into ciudad values('Munich', 'Alemania', 6089, 'fssd', 'CET', 'Munich Airport');
INSERT INTO ciudad VALUES('Hamburgo', 'Alemania', 5867, 'jhiu', 'CET', 'Aeropuerto de Hamburgo-Fuhlsbüttel');
insert into ciudad values('Buenos Aires', 'Argentina', 4545, 'fssd', 'America/Cordoba', 'Aeropuerto Internacional de Ezeiza');
insert into ciudad values('São Paulo', 'Brasil', 4619, 'fssd', 'BRST', 'Aeropuerto Campo de Marte');
insert into ciudad values('Rio de Janeiro', 'Brasil', 4589, 'fssd', 'America/Sao_Paulo', 'Aeropuerto de Rio de Janeiro Santos Dumont');
insert into ciudad values('Porto Alegre', 'Brasil', 4498, 'fssd', 'AMT', 'Aeropuerto de Porto Alegre');
insert into ciudad values('Vancouver', 'Canada', 2452, 'fssd', 'PST', 'Vancouver International Airport');
insert into ciudad values('Santiago de Chile', 'Chile', 4113, 'fssd', 'America/Santiago', 'Aeropuerto Internacional Comodoro Arturo')
insert into ciudad values('Pekin', 'China', 7746, 'fssd', 'CNT', 'Beijing Capital International Airport');
insert into ciudad values('Shangai', 'China', 8012, 'fssd', 'CNT', 'Shanghai Hongqiao International Airport');
insert into ciudad values('Hong Kong', 'China', 8790, 'fssd', 'HKT', 'Hong Kong International Airport');
insert into ciudad values('Seul', 'Corea del Sur', 7492, 'fssd', 'KST', 'Gimpo International Airport');
insert into ciudad values('Jeju Do', 'Corea del Sur', 7497, 'fssd', 'KST', 'Jeju International Airport');
insert into ciudad values('Busan', 'Corea del Sur', 7516, 'fssd', 'KST', 'Gimhae International Airport');
insert into ciudad values('Incheon', 'Corea del Sur', 7502, 'fssd', 'KST', 'Incheon International Airport');
insert into ciudad values('Dubai', 'Emiratos Árabes Unidos', 8902, 'fssd', 'GST', 'Aeropuerto Internacional de Dubái');
insert into ciudad values('Abu Dhabi', 'Emiratos Árabes Unidos', 8894, 'fssd', 'GST', 'Aeropuerto Internacional de Abu Dabi');
insert into ciudad values('El Cairo', 'Egipto', 7583, 'fssd', 'EET', 'Cairo International Airport');
insert into ciudad values('New York', 'Estados Unidos', 20886, 'fssd', 'EST', 'Aeropuerto Internacional John F. Kennedy');
insert into ciudad values('Paris', 'Francia', 5645, 'fssd', 'CET', 'Aeropuerto de Parí­s-Charles de Gaulle');
insert into ciudad values('Toulon', 'Francia', 5575, 'fssd', 'CET', 'Aeropuerto de Toulon–Hyères');
insert into ciudad values('London', 'Inglaterra', 5548, 'fssd', 'GMT', 'London Heathrow Airport');
insert into ciudad values('Amsterdam', 'Holanda',5713 , 'fssd', 'CET', 'Amsterdam Schiphol Airport');
insert into ciudad values('Jerusalén', 'Israel', 7720, 'fssd', 'IST', 'Aeropuerto Internacional Ben Gurión');
insert into ciudad values('Florencia', 'Italia', 6253, 'fssd', 'CET', 'ad');
insert into ciudad values('Tokio', 'Japón', 7002, 'fssd', 'JST', 'Tokyo International Airport Haneda');
insert into ciudad values('Tokoname', 'Japón', 7182, 'fssd', 'JST', 'Central Japan International Airport');
insert into ciudad values('Ciudad de México', 'México', 0, 'dasda', 'CST', 'Aeropuerto Internacional de la Ciudad de México');
insert into ciudad values('Toluca', 'México', 35, 'dasda', 'CST', 'Aeropuerto Internacional Lic. Adolfo López Mateos');
insert into ciudad values('Cancún', 'México', 805, 'adsd', 'CST', 'Aeropuerto Internacional de Cancún');
insert into ciudad values('Monterrey', 'México', 438, 'fssd', 'CST', 'Aeropuerto Internacional de Monterrey');
insert into ciudad values('Acapulco', 'México', 184, 'fssd', 'CST', 'Aeropuerto Internacional General Juan N. Álvarez');
insert into ciudad values('Guadalajara', 'México', 286, 'fssd', 'CST', 'Aeropuerto Internacional de Guadalajara');
insert into ciudad values('Singapur', 'Singapur', 9994, 'fssd', 'SGT', 'Singapur Changi Airport');
insert into ciudad values('Bankok', 'Tailandia', 9789, 'fssd', 'ICT', 'Aeropuerto Internacional Suvarnabhumi');
insert into ciudad values('Estambul', 'Turquia', 7089, 'fssd', 'EET', 'Aeropuerto Internacional Atatürk');
INSERT INTO ciudad VALUES('Sydney', 'Australia', , '', '', '');
INSERT INTO ciudad VALUES('Viena", "Austria', , '', '', '');
INSERT INTO ciudad VALUES('Bruselas', 'Bélgica', , '', '', '');
INSERT INTO ciudad VALUES('Toronto', 'Canadá', , '', '', '');
INSERT INTO ciudad VALUES("Las Vegas", "EEUU", , '', '', '');
INSERT INTO ciudad VALUES("Los Angeles", "EEUU", , '', '', '');
INSERT INTO ciudad VALUES("Miami", "EEUU", , '', '', '');
INSERT INTO ciudad VALUES("Nueva York", "EEUU", , '', '', '');
INSERT INTO ciudad VALUES("Barcelona", "España", , '', '', '');
INSERT INTO ciudad VALUES("Madrid", "España", , '', '', '');
INSERT INTO ciudad VALUES("Atenas", "Grecia", , '', '', '');
INSERT INTO ciudad VALUES("Budapest", "Hungría", , '', '', '');
INSERT INTO ciudad VALUES("Delhi", "India", , '', '', '');
INSERT INTO ciudad VALUES("Dublin", "Irlanda", , '', '', '');
INSERT INTO ciudad VALUES("Milan", "Italia", , '', '', '');
INSERT INTO ciudad VALUES("Roma", "Italia", , '', '', '');
INSERT INTO ciudad VALUES("Venecia", "Italia", , '', '', '');
INSERT INTO ciudad VALUES("Nagasaki", "Japón", , '', '', '');
INSERT INTO ciudad VALUES("Kyoto", "Japón", , '', '', '');
INSERT INTO ciudad VALUES("Kuala Lumpur", "Malasia", , '', '', '');
INSERT INTO ciudad VALUES("Lisboa", "Portugal", , '', '', '');
INSERT INTO ciudad VALUES("Oporto", "Portugal", , '', '', '');
INSERT INTO ciudad VALUES("Praga", "República Checa", , '', '', '');
INSERT INTO ciudad VALUES("Punta Cana", "Rep. Dominicana", , '', '', '');
INSERT INTO ciudad VALUES("Moscú", "Rusia", , '', '', '');
INSERT INTO ciudad VALUES("San Petersburgo", "Rusia", , '', '', '');
INSERT INTO ciudad VALUES("Taipei", "Taiwan", , '', '', '');
INSERT INTO ciudad VALUES("Hanoi", "Vietnam", , '', '', '');
INSERT INTO ciudad VALUES("Morelia", "México", , '', '', '');
INSERT INTO ciudad VALUES("Los Cabos", "México", , '', '', '');
INSERT INTO ciudad VALUES("Puerto Vallarta", "México", , '', '', '');
INSERT INTO ciudad VALUES("Cozumel", "México", , '', '', '');
INSERT INTO ciudad VALUES("Mérida", "México", , '', '', '');
INSERT INTO ciudad VALUES("Mazatlán", "México", , '', '', '');
INSERT INTO ciudad VALUES("La Paz", "México", , '', '', '');
INSERT INTO ciudad VALUES("Saltillo", "México", , '', '', '');
INSERT INTO ciudad VALUES("Xalapa", "México", , '', '', '');
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')
insert into ciudad values('', '', , 'fssd', '', '')

SELECT current_timestamp::TIMESTAMP WITH TIME ZONE AT TIME ZONE 'BRST';
select '22:00:00'::TIME WITH TIME ZONE AT TIME ZONE 'BRST';

create table horas(
  origen text references ciudads(nombre),
  destino text references ciudads(nombre),
  fechasalida date,
  horasalida time with time zone,
  tiempo interval,
  fechallegada date,
  horallegada time with time zone
);
create or replace function fhoras() returns trigger as $thoras$
  begin
    new.horasalida = cast(new.horasalida::time without time zone ||' '|| (select zonahora from ciudads where nombre = new.origen) as time with time zone);
    new.horallegada = (new.horasalida + new.tiempo)::time with time zone at time zone (select zonahora from ciudads where nombre = new.destino);
    new.fechallegada = cast(cast(((select current_date)+ new.horasalida + new.tiempo)::timestamp with time zone at time zone (select zonahora from ciudads where nombre = new.destino) as timestamp) as date);
    return new;
  end;
$thoras$ language plpgsql;

create trigger thoras
before insert on horas
for each row
execute procedure fhoras()

insert into horas values ('Ciudad de México', 'Berlin', (select current_date), (select current_time), '02:30', null, null);
insert into horas values ('Berlin', 'Ciudad de México', (select current_date), (select current_time), '02:30', null, null);
select '18:00:00 CST';
select * from horas
